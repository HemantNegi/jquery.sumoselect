/*!
 * jquery.sumoselect - v3.0.3
 * http://hemantnegi.github.io/jquery.sumoselect
 * 2016-12-12
 *
 * Copyright 2015 Hemant Negi
 * Email : hemant.frnz@gmail.com
 * Compressor http://refresh-sf.com/
 */
!function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):"undefined"!=typeof exports?module.exports=e(require("jquery")):e(jQuery)}((function(e){e.fn.SumoSelect=function(t){var l=e.extend({placeholder:"Select Here",csvDispCount:3,captionFormat:"{0} Selected",captionFormatAllSelected:"{0} all selected!",floatWidth:400,forceCustomRendering:!1,nativeOnDevice:["Android","BlackBerry","iPhone","iPad","iPod","Opera Mini","IEMobile","Silk"],outputAsCSV:!1,csvSepChar:",",okCancelInMulti:!1,isClickAwayOk:!1,triggerChangeCombined:!0,selectAll:!1,search:!1,searchText:"Search...",searchFn:function(e,t){return e.toLowerCase().indexOf(t.toLowerCase())<0},noMatch:'No matches for "{0}"',prefix:"",locale:["OK","Cancel","Select All"],up:!1,showTitle:!0},t),i=this.each((function(){var i=this;!this.sumo&&e(this).is("select")&&(this.sumo={E:e(i),is_multi:e(i).attr("multiple"),select:"",caption:"",placeholder:"",optDiv:"",CaptionCont:"",ul:"",is_floating:!1,is_opened:!1,mob:!1,Pstate:[],lastUnselected:null,createElems:function(){var t=this;t.E.wrap('<div class="SumoSelect" tabindex="0" role="button" aria-expanded="false">'),t.select=t.E.parent(),t.caption=e("<span>"),t.CaptionCont=e('<p class="CaptionCont SelectBox" ><label><i></i></label></p>').attr("style",t.E.attr("style")).prepend(t.caption),t.select.append(t.CaptionCont),t.is_multi||(l.okCancelInMulti=!1),t.E.attr("disabled")&&t.select.addClass("disabled").removeAttr("tabindex"),l.outputAsCSV&&t.is_multi&&t.E.attr("name")&&(t.select.append(e('<input class="HEMANT123" type="hidden" />').attr("name",t.E.attr("name")).val(t.getSelStr())),t.E.removeAttr("name")),!t.isMobile()||l.forceCustomRendering?(t.E.attr("name")&&t.select.addClass("sumo_"+t.E.attr("name").replace(/\[\]/,"")),t.E.addClass("SumoUnder").attr("tabindex","-1"),t.optDiv=e('<div class="optWrapper '+(l.up?"up":"")+'">'),t.floatingList(),t.ul=e('<ul class="options">'),t.optDiv.append(t.ul),l.selectAll&&t.is_multi&&t.SelAll(),l.search&&t.Search(),t.ul.append(t.prepItems(t.E.children())),t.is_multi&&t.multiSelelect(),t.select.append(t.optDiv),t.basicEvents(),t.selAllState()):t.setNativeMobile()},prepItems:function(t,l){var i=[],n=this;return e(t).each((function(t,s){s=e(s),i.push(s.is("optgroup")?e('<li class="group '+(s[0].disabled?"disabled":"")+'"><label>'+s.attr("label")+"</label><ul></ul></li>").find("ul").append(n.prepItems(s.children(),s[0].disabled)).end():n.createLi(s,l))})),i},createLi:function(t,l){var i=this;t.attr("value")||t.attr("value",t.val());var n=e('<li class="opt"><label>'+t.text()+"</label></li>");return n.data("opt",t),t.data("li",n),i.is_multi&&n.prepend("<span><i></i></span>"),(t[0].disabled||l)&&(n=n.addClass("disabled")),i.onOptClick(n),t[0].selected&&n.addClass("selected"),t.attr("class")&&n.addClass(t.attr("class")),t.attr("title")&&n.attr("title",t.attr("title")),n},getSelStr:function(){var t=[];return this.E.find("option:selected").each((function(){t.push(e(this).val())})),t.join(l.csvSepChar)},multiSelelect:function(){var t=this;t.optDiv.addClass("multiple"),t.okbtn=e('<p tabindex="0" class="btnOk">'+l.locale[0]+"</p>").click((function(){t._okbtn(),t.hideOpts()})),t.cancelBtn=e('<p tabindex="0" class="btnCancel">'+l.locale[1]+"</p>").click((function(){t._cnbtn(),t.hideOpts()}));var i=t.okbtn.add(t.cancelBtn);t.optDiv.append(e('<div class="MultiControls">').append(i)),i.on("keydown.sumo",(function(l){var i=e(this);switch(l.which){case 32:case 13:i.trigger("click");break;case 9:if(i.hasClass("btnOk"))return;case 27:return t._cnbtn(),void t.hideOpts()}l.stopPropagation(),l.preventDefault()}))},_okbtn:function(){var e=this,t=0;l.triggerChangeCombined&&(e.E.find("option:selected").length!==e.Pstate.length?t=1:e.E.find("option").each((function(l,i){i.selected&&e.Pstate.indexOf(l)<0&&(t=1)})),t&&(e.callChange(),e.setText()))},_cnbtn:function(){var e=this;e.E.find("option:selected").each((function(){this.selected=!1})),e.optDiv.find("li.selected").removeClass("selected");for(var t=0;t<e.Pstate.length;t++)e.E.find("option")[e.Pstate[t]].selected=!0,e.ul.find("li.opt").eq(e.Pstate[t]).addClass("selected");e.selAllState()},SelAll:function(){var t=this;t.is_multi&&(t.selAll=e('<p class="select-all"><span><i></i></span><label>'+l.locale[2]+"</label></p>"),t.optDiv.addClass("selall"),t.selAll.on("click",(function(){t.selAll.toggleClass("selected"),t.toggSelAll(t.selAll.hasClass("selected"),1)})),t.optDiv.prepend(t.selAll))},Search:function(){var i=this,n=i.CaptionCont.addClass("search"),s=e('<p class="no-match">'),a=t.searchFn&&"function"==typeof t.searchFn?t.searchFn:l.searchFn;i.ftxt=e('<input type="text" class="search-txt" value="" placeholder="'+l.searchText+'">').on("click",(function(e){e.stopPropagation()})),n.append(i.ftxt),i.optDiv.children("ul").after(s),i.ftxt.on("keyup.sumo",(function(){var t=i.optDiv.find("ul.options li.opt").each((function(t,l){var l,n=(l=e(l)).data("opt")[0];n.hidden=a(l.text(),i.ftxt.val()),l.toggleClass("hidden",n.hidden)})).not(".hidden");s.html(l.noMatch.replace(/\{0\}/g,"<em></em>")).toggle(!t.length),s.find("em").text(i.ftxt.val()),i.selAllState()}))},selAllState:function(){var t=this;if(l.selectAll&&t.is_multi){var i=0,n=0;t.optDiv.find("li.opt").not(".hidden").each((function(t,l){e(l).hasClass("selected")&&i++,e(l).hasClass("disabled")||n++})),i===n?t.selAll.removeClass("partial").addClass("selected"):0===i?t.selAll.removeClass("selected partial"):t.selAll.addClass("partial")}},showOpts:function(){var t=this;if(!t.E.attr("disabled")){if(t.E.trigger("sumo:opening",t),t.is_opened=!0,t.select.addClass("open").attr("aria-expanded","true"),t.E.trigger("sumo:opened",t),t.ftxt?t.ftxt.focus():t.select.focus(),e(document).on("click.sumo",(function(e){if(!t.select.is(e.target)&&0===t.select.has(e.target).length){if(!t.is_opened)return;t.hideOpts(),l.okCancelInMulti&&(l.isClickAwayOk?t._okbtn():t._cnbtn())}})),t.is_floating){var i=t.optDiv.children("ul").outerHeight()+2;t.is_multi&&(i+=parseInt(t.optDiv.css("padding-bottom"))),t.optDiv.css("height",i),e("body").addClass("sumoStopScroll")}t.setPstate()}},setPstate:function(){var e=this;e.is_multi&&(e.is_floating||l.okCancelInMulti)&&(e.Pstate=[],e.E.find("option").each((function(t,l){l.selected&&e.Pstate.push(t)})))},callChange:function(){this.E.get().forEach(e=>{e.dispatchEvent(new Event("change")),e.dispatchEvent(new Event("click"))})},hideOpts:function(){var t=this;t.is_opened&&(t.E.trigger("sumo:closing",t),t.is_opened=!1,t.select.removeClass("open").attr("aria-expanded","true").find("ul li.sel").removeClass("sel"),t.E.trigger("sumo:closed",t),e(document).off("click.sumo"),t.select.focus(),e("body").removeClass("sumoStopScroll"),l.search&&(t.ftxt.val(""),t.ftxt.trigger("keyup.sumo")))},setOnOpen:function(){var e=this,t=e.optDiv.find("li.opt:not(.hidden)").eq(l.search?0:e.E[0].selectedIndex);t.hasClass("disabled")&&!(t=t.next(":not(disabled)")).length||(e.optDiv.find("li.sel").removeClass("sel"),t.addClass("sel"),e.showOpts())},nav:function(e){var t=this,l,i=t.ul.find("li.opt:not(.disabled, .hidden)"),n=t.ul.find("li.opt.sel:not(.hidden)"),s=i.index(n);if(t.is_opened&&n.length){if(e&&s>0)l=i.eq(s-1);else{if(!(!e&&s<i.length-1&&s>-1))return;l=i.eq(s+1)}n.removeClass("sel"),n=l.addClass("sel");var a=t.ul,o=a.scrollTop(),c=n.position().top+o;c>=o+a.height()-n.outerHeight()&&a.scrollTop(c-a.height()+n.outerHeight()),c<o&&a.scrollTop(c)}else t.setOnOpen()},basicEvents:function(){var t=this;t.CaptionCont.click((function(e){t.E.trigger("click"),t.is_opened?t.hideOpts():t.showOpts(),e.stopPropagation()})),t.select.on("keydown.sumo",(function(e){switch(e.which){case 38:t.nav(!0);break;case 40:t.nav(!1);break;case 65:if(t.is_multi&&e.ctrlKey){t.toggSelAll(!e.shiftKey,1);break}return;case 32:if(l.search&&t.ftxt.is(e.target))return;case 13:t.is_opened?t.optDiv.find("ul li.sel").trigger("click"):t.setOnOpen();break;case 9:return void(l.okCancelInMulti||t.hideOpts());case 27:return l.okCancelInMulti&&t._cnbtn(),void t.hideOpts();default:return}e.preventDefault()})),e(window).on("resize.sumo",(function(){t.floatingList()}))},onOptClick:function(t){var i=this;t.click((function(){var t=e(this);if(!t.hasClass("disabled")){var n="";i.is_multi?(t.toggleClass("selected"),t.data("opt")[0].selected=t.hasClass("selected"),!1===t.data("opt")[0].selected&&(i.lastUnselected=t.data("opt")[0].textContent),i.selAllState()):(t.parent().find("li.selected").removeClass("selected"),t.toggleClass("selected"),t.data("opt")[0].selected=!0),i.is_multi&&l.triggerChangeCombined&&(i.is_floating||l.okCancelInMulti)||(i.setText(),i.callChange()),i.is_multi||i.hideOpts()}}))},setText:function(){var t=this;if(t.placeholder="",t.is_multi){for(var i=t.E.find(":selected").not(":disabled"),n=0;n<i.length;n++){if(n+1>=l.csvDispCount&&l.csvDispCount){i.length===t.E.find("option").length&&l.captionFormatAllSelected?t.placeholder=l.captionFormatAllSelected.replace(/\{0\}/g,i.length)+",":t.placeholder=l.captionFormat.replace(/\{0\}/g,i.length)+",";break}t.placeholder+=e(i[n]).text()+", "}t.placeholder=t.placeholder.replace(/,([^,]*)$/,"$1")}else t.placeholder=t.E.find(":selected").not(":disabled").text();var s=!1;t.placeholder||(s=!0,t.placeholder=t.E.attr("placeholder"),t.placeholder||(t.placeholder=t.E.find("option:disabled:selected").text())),t.placeholder=t.placeholder?l.prefix+" "+t.placeholder:l.placeholder,t.caption.html(t.placeholder),l.showTitle&&t.CaptionCont.attr("title",t.placeholder);var a=t.select.find("input.HEMANT123");return a.length&&a.val(t.getSelStr()),s?t.caption.addClass("placeholder"):t.caption.removeClass("placeholder"),t.placeholder},isMobile:function(){for(var e=navigator.userAgent||navigator.vendor||window.opera,t=0;t<l.nativeOnDevice.length;t++)if(e.toString().toLowerCase().indexOf(l.nativeOnDevice[t].toLowerCase())>0)return l.nativeOnDevice[t];return!1},setNativeMobile:function(){var e=this;e.E.addClass("SelectClass"),e.mob=!0,e.E.change((function(){e.setText()}))},floatingList:function(){var t=this;t.is_floating=e(window).width()<=l.floatWidth,t.optDiv.toggleClass("isFloating",t.is_floating),t.is_floating||t.optDiv.css("height",""),t.optDiv.toggleClass("okCancelInMulti",l.okCancelInMulti&&!t.is_floating)},vRange:function(e){var t=this,l;if(t.E.find("option").length<=e||e<0)throw"index out of bounds";return t},toggSel:function(t,l){var i=this,n;"number"==typeof l?(i.vRange(l),n=i.E.find("option")[l]):n=i.E.find('option[value="'+l+'"]')[0]||0,n&&!n.disabled&&n.selected!==t&&(n.selected=t,i.mob||e(n).data("li").toggleClass("selected",t),i.callChange(),i.setPstate(),i.setText(),i.selAllState())},toggDis:function(e,t){var l=this.vRange(t);l.E.find("option")[t].disabled=e,e&&(l.E.find("option")[t].selected=!1),l.mob||l.optDiv.find("ul.options li").eq(t).toggleClass("disabled",e).removeClass("selected"),l.setText()},toggSumo:function(e){var t=this;return t.enabled=e,t.select.toggleClass("disabled",e),e?(t.E.attr("disabled","disabled"),t.select.removeAttr("tabindex")):(t.E.removeAttr("disabled"),t.select.attr("tabindex","0")),t},toggSelAll:function(t,l){var i=this;i.E.find("option:not(:disabled,:hidden)").each((function(l,i){var n=i.selected,i;(i=e(i).data("li")).hasClass("hidden")||(t?n||i.trigger("click"):n&&i.trigger("click"))})),l||(!i.mob&&i.selAll&&i.selAll.removeClass("partial").toggleClass("selected",!!t),i.callChange(),i.setText(),i.setPstate())},reload:function(){var t=this.unload();return e(t).SumoSelect(l)},unload:function(){var e=this;return e.select.before(e.E),e.E.show(),l.outputAsCSV&&e.is_multi&&e.select.find("input.HEMANT123").length&&e.E.attr("name",e.select.find("input.HEMANT123").attr("name")),e.select.remove(),delete i.sumo,i},add:function(t,l,n){if(void 0===t)throw"No value to add";var s=this,a=s.E.find("option");"number"==typeof l&&(n=l,l=t),void 0===l&&(l=t);var o=e("<option></option>").val(t).html(l);if(a.length<n)throw"index out of bounds";return void 0===n||a.length===n?(s.E.append(o),s.mob||s.ul.append(s.createLi(o))):(a.eq(n).before(o),s.mob||s.ul.find("li.opt").eq(n).before(s.createLi(o))),i},remove:function(e){var t=this.vRange(e);t.E.find("option").eq(e).remove(),t.mob||t.optDiv.find("ul.options li").eq(e).remove(),t.setText()},removeAll:function(){for(var e=this,t=e.E.find("option"),l=t.length-1;l>=0;l--)!0!==t[l].selected&&e.remove(l)},find:function(e){var t,l=this.E.find("option");for(var i in l)if(l[i].value===e)return parseInt(i);return-1},selectItem:function(e){this.toggSel(!0,e)},unSelectItem:function(e){this.toggSel(!1,e)},selectAll:function(){this.toggSelAll(!0)},unSelectAll:function(){this.toggSelAll(!1)},disableItem:function(e){this.toggDis(!0,e)},enableItem:function(e){this.toggDis(!1,e)},enabled:!0,enable:function(){return this.toggSumo(!1)},disable:function(){return this.toggSumo(!0)},init:function(){var e=this;return e.createElems(),e.setText(),e}},i.sumo.init())}));return 1===i.length?i[0]:i}}));